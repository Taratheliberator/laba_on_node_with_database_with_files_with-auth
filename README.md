
# Проект: API для управления продуктами и пользователями

##

---

## Функциональность

- **Управление пользователями:**

  - Регистрация пользователей с email и паролем.
  - Активация аккаунтов через email.
  - Middleware для проверки токенов аутентификации.

- **Управление продуктами:**

  - Создание, просмотр и управление продуктами.
  - Поддержка загрузки изображений продуктов.

- **Управление категориями:**

  - Создание и просмотр категорий для продуктов.

---

## Предварительные требования

1. **Node.js**: Установите Node.js с [официального сайта](https://nodejs.org/).
2. **PostgreSQL**: Убедитесь, что PostgreSQL установлен и запущен.
3. **npm или yarn**: Менеджер пакетов для Node.js.

---

## Настройка и установка

1. Клонируйте репозиторий:

   ```bash
   git clone <repository_url>
   cd <repository_name>
   ```

2. Установите зависимости:

   ```bash
   npm install
   ```

3. Настройте базу данных:

   - Откройте `config/database.js` и обновите учетные данные для базы данных (например, `username`, `password`, и `host`).
   - Создайте базу данных в PostgreSQL:
     ```sql
     CREATE DATABASE product_db;
     ```

4. Выполните миграции и синхронизацию моделей:

   ```bash
   node app.js
   ```

   Это создаст таблицы в вашей базе данных.

5. Настройте учетные данные для отправки email:

   - В файле `controllers/userController.js` обновите учетные данные Gmail.

   ```javascript
   const transporter = nodemailer.createTransport({
     service: 'gmail',
     auth: {
       user: 'ваш_email@gmail.com',
       pass: 'ваш_пароль_приложения',
     },
   });
   ```

---

## Запуск сервера

Запустите сервер:

```bash
node app.js
```

Сервер будет доступен по адресу `http://localhost:3000`.

---

## API Эндпоинты

### Эндпоинты пользователей

- **POST** `/register`: Регистрация нового пользователя.

  ```json
  {
    "email": "user@example.com",
    "password": "your_password"
  }
  ```

- **GET** `/activate/:token`: Активация аккаунта пользователя через токен из email.

### Эндпоинты продуктов

- **GET** `/products`: Получение всех продуктов.

- **POST** `/products`: Создание нового продукта.

  ```json
  {
    "name": "Название продукта",
    "price": 100,
    "categoryId": 1
  }
  ```

- **POST** `/products/upload`: Загрузка изображения для продукта.

### Эндпоинты категорий

- **GET** `/categories`: Получение всех категорий.
- **POST** `/categories`: Создание новой категории.
  ```json
  {
    "name": "Название категории"
  }
  ```

---

## Middleware

### Middleware для аутентификации

Файл `authMiddleware.js` проверяет JWT токены, отправленные в заголовках запросов, и обеспечивает доступ только для аутентифицированных пользователей.

---

## Модели

### User

- **email**: Email пользователя (уникальный).
- **password**: Хэшированный пароль пользователя.
- **isActivated**: Статус активации.

### Product

- **name**: Название продукта.
- **price**: Цена продукта.
- **categoryId**: Внешний ключ к `Category`.

### Category

- **name**: Название категории.

---

## Используемые технологии

- **Node.js**: Среда выполнения для сервера.
- **Express**: Фреймворк для веб-приложений.
- **Sequelize**: ORM для работы с базой данных.
- **PostgreSQL**: Реляционная база данных.
- **Nodemailer**: Отправка email.
- **Multer**: Обработка загрузки файлов.

---

## Примечания

- Убедитесь, что база данных запущена перед запуском сервера.
- Используйте действительные учетные данные Gmail для отправки email.
- Для тестирования API используйте Postman или аналогичный клиент.

---


